## Vulnerability Report

### Vulnerability 1: Missing function level access control
#### Exposure 
- Some of controllers and its methods did not specified its access level. Other than Admin Controller,
where only the admin application role holders are accessible to see and manage the data of ECommerce site,
did not have much control as far as who can and cannot access certain pages within the application.

#### Repair
- For pages that are only accessible under admin role are controlled with AdminOnly policy. Through utilizing 
the claim and policy, it give no room for intruders to manipulate its data and code to earn the access to the 
pages that holds sensitive data.

```
// Methods that are only accessible by Administrators are applied with a policy.
[Authorize(Policy = "AdminOnly")]
```

- Also, using the ASP.NET Authorization, it controlls access for users who has not been registered or logged in
into the application.

```
// All the pages that are assessible by anyone are set with:
[AllowAnonymous]

// Where as rest of the pages are controlled with:
// Not granting any access to ones who has not been registered / logged in.
[Authorize]
```

### Vulnerability 2: Cross site request forgery
#### Exposure
- Cross-Site Request Forgery is an attack where a malicious site sends a request to a vulnerable 
site where the user is currently logged in. Methods with transfering its data using Http Get and Post were prone for intruders
to manipulate its information that could cost unwanted loss of sensitive data. Security implementation of transfering data
through Http Get and Post were in needed to secure and protect the data that holdes within the application database.

#### Repair
- To avoid the cross site request forgery, we implemented the the Validation of Anti-Forgery Token.
Validation Anti-forger token prevents the cross site request forgery by sending the hidden token when
Http Get and post methods for data manipulation validation.
- On every HTTP Post method we implemented the ASP.NET MVP anti-forgery:
```
[ValidateAntiForgeryToken]
```

 And we also added anti-forgery in razor page using HtmlHelper.AntiForgeryToken:
 
 ```
 @using (Html.BeginForm("OnPost", "UserProfile"))
{
    @Html.AntiForgeryToken()
}
```